<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ibm.issue.dao.UserAndIdentityMapper">
<resultMap id="UserAndIdentity" type="com.ibm.issue.pojo.User">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="userId" jdbcType="VARCHAR" property="userid" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="signUp" jdbcType="DATE" property="signup" />
    <result column="permission" jdbcType="INTEGER" property="permission" />
    <result column="userState" jdbcType="CHAR" property="userstate" />
    <association property="identity" javaType="com.ibm.issue.pojo.Identity">
            <id column="id" property="id" jdbcType="INTEGER" />
            <result column="pid" property="pid" jdbcType="INTEGER" />
            <result column="position" property="position" jdbcType="VARCHAR" />
        </association>
  </resultMap>
  <select id="findUserAndIdentity" resultMap="UserAndIdentity">
       select user.userId,user.name,user.email,user.password,user.signUp,user.userState,identity.position
        from   user,identity
        where  user.permission = identity.pid 
        <if test="user != null">
        	<if test="user.userid != null">
        	AND user.userId like concat('%', #{user.userid}, '%')
        	</if>
        </if>
        <if test="user != null">
        	<if test="user.name != null">
        	AND user.name like concat('%', #{user.name}, '%')
        	</if>
        </if>
    </select>
</mapper>